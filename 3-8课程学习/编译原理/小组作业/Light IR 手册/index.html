
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Apostle-lemon">
      
      
        <link rel="canonical" href="https://apostle-lemon.github.io./3-8%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E5%B0%8F%E7%BB%84%E4%BD%9C%E4%B8%9A/Light%20IR%20%E6%89%8B%E5%86%8C/">
      
      
      
      <link rel="icon" href="../../../../img/yileina.ico">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Light IR - lemonğŸ‹</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../css/extra.css">
    
      <link rel="stylesheet" href="../../../../css/color.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="yellow">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#light-ir" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../../../.." title="lemonğŸ‹" class="md-header__button md-logo" aria-label="lemonğŸ‹" data-md-component="logo">
      
  <img src="../../../../img/yileina2.jpeg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            lemonğŸ‹
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Light IR
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="åˆ†äº«" aria-label="åˆ†äº«" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Apostle-lemon" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ğŸ‹çš„githubä¸»é¡µ
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      æ˜¯æŸ æª¬
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E3%80%90%E8%A7%86%E9%A2%91%E3%80%91%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="md-tabs__link">
        è¯¾ç¨‹å­¦ä¹ 
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/store/mongodb/mongodb%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/" class="md-tabs__link">
        çŸ¥è¯†æ¬¢æ„‰
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="lemonğŸ‹" class="md-nav__button md-logo" aria-label="lemonğŸ‹" data-md-component="logo">
      
  <img src="../../../../img/yileina2.jpeg" alt="logo">

    </a>
    lemonğŸ‹
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Apostle-lemon" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ğŸ‹çš„githubä¸»é¡µ
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        æ˜¯æŸ æª¬
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          è¯¾ç¨‹å­¦ä¹ 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          è¯¾ç¨‹å­¦ä¹ 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          è®¡ç®—æœºç½‘ç»œ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          è®¡ç®—æœºç½‘ç»œ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E3%80%90%E8%A7%86%E9%A2%91%E3%80%91%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        [è§†é¢‘] è®¡ç®—æœºç½‘ç»œ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          è®¡ç®—æœºç³»ç»ŸäºŒ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          è®¡ç®—æœºç³»ç»ŸäºŒ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E4%BA%8C/%E3%80%90%E6%99%BA%E4%BA%91%E8%AF%BE%E5%A0%82%E3%80%91%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E4%BA%8C/" class="md-nav__link">
        [æ™ºäº‘è¯¾å ‚] è®¡ç®—æœºç³»ç»ŸäºŒ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          è®¡ç®—ç†è®º
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          è®¡ç®—ç†è®º
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E4%B8%8D%E6%83%B3%E5%AD%A6%E4%BA%86/" class="md-nav__link">
        ä½ å¥½
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          ç¼–è¯‘åŸç†
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          ç¼–è¯‘åŸç†
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E3%80%90%E4%B8%8A%E8%AF%BE%E3%80%91%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" class="md-nav__link">
        ç¼–è¯‘åŸç†
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          çŸ¥è¯†æ¬¢æ„‰
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          çŸ¥è¯†æ¬¢æ„‰
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          mongodb
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          mongodb
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/store/mongodb/mongodb%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/" class="md-nav__link">
        Mongodb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/store/mongodb/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20Go%20%E8%BF%9E%E6%8E%A5%E8%BF%9C%E7%A8%8B%20Linux-mongodb/" class="md-nav__link">
        å¦‚ä½•ä½¿ç”¨ Go è¿æ¥è¿œç¨‹ Linux-mongodb
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          è¯­è¨€ç›¸å…³
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          è¯­è¨€ç›¸å…³
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
          golang
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          golang
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_1" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_1_1" id="__nav_3_2_1_1_label" tabindex="0">
          å½’æ¡£
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_1_1">
          <span class="md-nav__icon md-icon"></span>
          å½’æ¡£
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/golang/%E5%BD%92%E6%A1%A3/Go%20%E6%97%A0%E6%B3%95%E5%AF%B9%20main%20%E6%A8%A1%E5%9D%97%E6%89%A7%E8%A1%8C%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        Go æ— æ³•å¯¹ Main æ¨¡å—æ‰§è¡Œæµ‹è¯•
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_1_2" id="__nav_3_2_1_2_label" tabindex="0">
          goç²¾è¿›ä¹‹è·¯
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_1_2">
          <span class="md-nav__icon md-icon"></span>
          goç²¾è¿›ä¹‹è·¯
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/golang/Go%E8%AF%AD%E8%A8%80%E7%B2%BE%E8%BF%9B%E4%B9%8B%E8%B7%AF/40%20%E5%8C%85%E5%86%85%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%8C%85%E5%A4%96%E6%B5%8B%E8%AF%95%E7%9A%84%E5%8C%BA%E5%88%AB/" class="md-nav__link">
        åŒ…å†…æµ‹è¯•ä¸åŒ…å¤–æµ‹è¯•çš„åŒºåˆ«
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/golang/Go%E8%AF%AD%E8%A8%80%E7%B2%BE%E8%BF%9B%E4%B9%8B%E8%B7%AF/41%20%E6%9C%89%E5%B1%82%E6%AC%A1%E5%9C%B0%E7%BB%84%E7%BB%87%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81/" class="md-nav__link">
        41 æœ‰å±‚æ¬¡åœ°ç»„ç»‡æµ‹è¯•ä»£ç 
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/golang/Go%E8%AF%AD%E8%A8%80%E7%B2%BE%E8%BF%9B%E4%B9%8B%E8%B7%AF/42%20%E4%BC%98%E5%85%88%E7%BC%96%E5%86%99%E8%A1%A8%E9%A9%B1%E5%8A%A8%E7%9A%84%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        42 ä¼˜å…ˆç¼–å†™è¡¨é©±åŠ¨çš„æµ‹è¯•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/golang/Go%E8%AF%AD%E8%A8%80%E7%B2%BE%E8%BF%9B%E4%B9%8B%E8%B7%AF/43%20%E4%BD%BF%E7%94%A8%20testdata%20%E7%AE%A1%E7%90%86%E6%B5%8B%E8%AF%95%E4%BE%9D%E8%B5%96%E7%9A%84%E5%A4%96%E9%83%A8%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6/" class="md-nav__link">
        43 ä½¿ç”¨ Testdata ç®¡ç†æµ‹è¯•ä¾èµ–çš„å¤–éƒ¨æ•°æ®æ–‡ä»¶
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%9F%A5%E8%AF%86%E6%AC%A2%E6%84%89/%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3/golang/Go%E8%AF%AD%E8%A8%80%E7%B2%BE%E8%BF%9B%E4%B9%8B%E8%B7%AF/44%20%E6%AD%A3%E7%A1%AE%E8%BF%90%E7%94%A8%20fake%20stub%20%E5%92%8C%20mock%20%E7%AD%89%E8%BE%85%E5%8A%A9%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        44 æ­£ç¡®è¿ç”¨ Fake Stub å’Œ Mock ç­‰è¾…åŠ©å•å…ƒæµ‹è¯•
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lightir-ç®€ä»‹" class="md-nav__link">
    LightIR ç®€ä»‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ir-æ ¼å¼" class="md-nav__link">
    IR æ ¼å¼
  </a>
  
    <nav class="md-nav" aria-label="IR æ ¼å¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ir-ç»“æ„å›¾" class="md-nav__link">
    IR ç»“æ„å›¾
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ir-æŒ‡ä»¤" class="md-nav__link">
    IR æŒ‡ä»¤
  </a>
  
    <nav class="md-nav" aria-label="IR æŒ‡ä»¤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#æŒ‡ä»¤æ ¼å¼" class="md-nav__link">
    æŒ‡ä»¤æ ¼å¼
  </a>
  
    <nav class="md-nav" aria-label="æŒ‡ä»¤æ ¼å¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terminator-instructions" class="md-nav__link">
    Terminator Instructions
  </a>
  
    <nav class="md-nav" aria-label="Terminator Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ret" class="md-nav__link">
    Ret
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#br" class="md-nav__link">
    Br
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#standard-binary-operators" class="md-nav__link">
    Standard Binary Operators
  </a>
  
    <nav class="md-nav" aria-label="Standard Binary Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-fadd" class="md-nav__link">
    Add FAdd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sub-fsub" class="md-nav__link">
    Sub FSub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mul-fmul" class="md-nav__link">
    Mul FMul
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdiv-fdiv" class="md-nav__link">
    SDiv FDiv
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-operators" class="md-nav__link">
    Memory Operators
  </a>
  
    <nav class="md-nav" aria-label="Memory Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alloca" class="md-nav__link">
    Alloca
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load" class="md-nav__link">
    Load
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#store" class="md-nav__link">
    Store
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#castinst" class="md-nav__link">
    CastInst
  </a>
  
    <nav class="md-nav" aria-label="CastInst">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zext" class="md-nav__link">
    ZExt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fptosi" class="md-nav__link">
    FpToSi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sitofp" class="md-nav__link">
    SiToFp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-operators" class="md-nav__link">
    Other Operators
  </a>
  
    <nav class="md-nav" aria-label="Other Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icmp-fcmp" class="md-nav__link">
    ICmp FCmp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call" class="md-nav__link">
    Call
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getelementptr" class="md-nav__link">
    GetElementPtr
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c-apis" class="md-nav__link">
    C++ APIs
  </a>
  
    <nav class="md-nav" aria-label="C++ APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c-ç±»å…³ç³»å›¾" class="md-nav__link">
    C++ ç±»å…³ç³»å›¾
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module" class="md-nav__link">
    Module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basicblock" class="md-nav__link">
    BasicBlock
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globalvariable" class="md-nav__link">
    GlobalVariable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constant" class="md-nav__link">
    Constant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#argument" class="md-nav__link">
    Argument
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    Function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#irbuilder" class="md-nav__link">
    IRBuilder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instruction" class="md-nav__link">
    Instruction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type" class="md-nav__link">
    Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    User
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use" class="md-nav__link">
    Use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value" class="md-nav__link">
    Value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#æ³¨æ„" class="md-nav__link">
    æ³¨æ„
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="light-ir">Light IR<a class="headerlink" href="#light-ir" title="Permanent link">&para;</a></h1>
<h2 id="lightir-ç®€ä»‹">LightIR ç®€ä»‹<a class="headerlink" href="#lightir-ç®€ä»‹" title="Permanent link">&para;</a></h2>
<p>ä¸ºäº†è®©åŒå­¦ä»¬æ–¹ä¾¿ç†è§£å¹¶æŒæ¡ IR æ ¸å¿ƒæŠ€æœ¯ï¼Œæˆ‘ä»¬ä»å¤æ‚ç¹ççš„ LLVM IR ä¸­è£å‰ªå‡ºäº†æœ¬è¯¾ç¨‹å®éªŒæ‰€éœ€è¦çš„ç²¾ç®€ IR å­é›†ï¼ˆæˆ‘ä»¬å°†å…¶å‘½åä¸º LightIRï¼‰ï¼Œå¹¶ä¸”å®ç°äº†è½»é‡çº§çš„åº“æ¥è¿›è¡Œ IR çš„æ§åˆ¶å’Œç”Ÿæˆã€‚æœ¬æ–‡æ¡£æ—¨åœ¨ä»‹ç» LightIR çš„ç»“æ„å’Œå…·ä½“æŒ‡ä»¤ï¼ŒåŒæ—¶å¯å½“ä½œ LightIR <a href="../../../LightIR.md#c-apis">C++ æ¥å£</a> çš„å‚è€ƒæ‰‹å†Œã€‚LightIR çš„ <a href="../../../LightIR.md#ir-æ ¼å¼">IR æ ¼å¼</a> å’Œ <a href="../../../LightIR.md#ir-æŒ‡ä»¤">IR æŒ‡ä»¤</a> éƒ¨åˆ†ä¹Ÿå¯ä»¥å‚è€ƒ LLVM å®˜æ–¹çš„ IR æ–‡æ¡£ <a href="http://llvm.org/docs/LangRef.html">LLVM Reference Manual</a>ã€‚</p>
<h2 id="ir-æ ¼å¼">IR æ ¼å¼<a class="headerlink" href="#ir-æ ¼å¼" title="Permanent link">&para;</a></h2>
<h3 id="ir-ç»“æ„å›¾">IR ç»“æ„å›¾<a class="headerlink" href="#ir-ç»“æ„å›¾" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../../../img/1904110b6df47e37c484729908defee4_MD5.png" /></p>
<p>æˆ‘ä»¬å®éªŒä¸­éœ€è¦ç”Ÿæˆçš„ IR ä»£ç æœ‰ç€ç›¸å¯¹å›ºå®šçš„ç»“æ„æ¨¡å¼ã€‚</p>
<ul>
<li>æœ€ä¸Šå±‚çš„æ˜¯æ¨¡å—ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå®Œæ•´ç¼–è¯‘å•å…ƒï¼Œæ¥æºäºä¸€ä¸ª <code>cminus-f</code> æºæ–‡ä»¶ã€‚æ¨¡å—åŒ…å«å…¨å±€å˜é‡å’Œå‡½æ•°å®šä¹‰ã€‚</li>
<li>å‡½æ•°ç”±å¤´éƒ¨å’Œå‡½æ•°ä½“ç»„æˆã€‚å‡½æ•°çš„å¤´éƒ¨åŒ…æ‹¬è¿”å›å€¼ç±»å‹ã€å‡½æ•°åå’Œå‚æ•°è¡¨ï¼ˆæ¯ä¸ªå‚æ•°åŒ…æ‹¬ç±»å‹å’Œå€¼ï¼‰ã€‚å‡½æ•°ä½“å¯ä»¥ç”±å¤šä¸ªåŸºæœ¬å—æ„æˆã€‚</li>
<li>åŸºæœ¬å—æ˜¯æŒ‡ç¨‹åºé¡ºåºæ‰§è¡Œçš„è¯­å¥åºåˆ—ï¼Œåªæœ‰ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£ã€‚åŸºæœ¬å—ç”±è‹¥å¹²æŒ‡ä»¤æ„æˆã€‚</li>
<li>æ³¨æ„ä¸€ä¸ªåŸºæœ¬å—ä¸­çš„ <strong>åªèƒ½æœ‰ä¸€æ¡ç»ˆæ­¢æŒ‡ä»¤</strong>ï¼ˆRet/Brï¼‰ã€‚</li>
</ul>
<p>ä»¥ä¸‹é¢çš„ <code>easy.c</code> ä¸ <code>easy.ll</code> ä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚</p>
<p>é€šè¿‡å‘½ä»¤ <code>clang -S -emit-llvm easy.c</code> å¯ä»¥å¾—åˆ°å¯¹åº”çš„ <code>easy.ll</code> å¦‚ä¸‹ï¼ˆåŠ©æ•™å¢åŠ äº†é¢å¤–çš„æ³¨é‡Šï¼‰ã€‚<code>.ll</code> æ–‡ä»¶ä¸­æ³¨é‡Šä»¥ <code>;</code> å¼€å¤´ã€‚</p>
<ul>
<li><code>easy.c</code>:  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(){</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li><code>easy.ll</code>:  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="p">.</span><span class="n">llæ–‡ä»¶ä¸­æ³¨é‡Šä»¥</span><span class="sc">&#39;;&#39;</span><span class="n">å¼€å¤´</span>
<span class="p">;</span><span class="w"> </span><span class="n">ModuleID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">easy</span><span class="p">.</span><span class="n">c</span><span class="err">&#39;</span>
<span class="n">source_filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;easy.c&quot;</span>
<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">targetçš„å¼€å§‹</span>
<span class="n">target</span><span class="w"> </span><span class="n">datalayout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-f80:128-n8:16:32:64-S128&quot;</span>
<span class="n">target</span><span class="w"> </span><span class="n">triple</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;x86_64-unknown-linux-gnu&quot;</span>
<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">targetçš„ç»“æŸ</span>

<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">å…¨å±€mainå‡½æ•°çš„å®šä¹‰</span>
<span class="p">;</span><span class="w"> </span><span class="n">Function</span><span class="w"> </span><span class="n">Attrs</span><span class="o">:</span><span class="w"> </span><span class="n">noinline</span><span class="w"> </span><span class="n">nounwind</span><span class="w"> </span><span class="n">optnone</span><span class="w"> </span><span class="n">uwtable</span>
<span class="n">define</span><span class="w"> </span><span class="n">dso_local</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="err">@</span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">ç¬¬ä¸€ä¸ªåŸºæœ¬å—çš„å¼€å§‹</span>
<span class="w">  </span><span class="o">%</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alloca</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alloca</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alloca</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="n">store</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="n">store</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="n">store</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="n">slt</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="o">%</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="mi">5</span>
<span class="w">  </span><span class="n">br</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="o">%</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">%</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">%</span><span class="mi">8</span>
<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">ç¬¬ä¸€ä¸ªåŸºæœ¬å—çš„ç»“æŸ</span>

<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">ç¬¬äºŒä¸ªåŸºæœ¬å—çš„å¼€å§‹</span>
<span class="mi">7</span><span class="o">:</span><span class="w">                                                </span><span class="p">;</span><span class="w"> </span><span class="n">preds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">%</span><span class="mi">0</span>
<span class="w">  </span><span class="n">store</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="n">br</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">%</span><span class="mi">8</span>
<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">ç¬¬äºŒä¸ªåŸºæœ¬å—çš„ç»“æŸ</span>

<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">ç¬¬ä¸‰ä¸ªåŸºæœ¬å—çš„å¼€å§‹</span>
<span class="mi">8</span><span class="o">:</span><span class="w">                                                </span><span class="p">;</span><span class="w"> </span><span class="n">preds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">%</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="mi">0</span>
<span class="w">  </span><span class="o">%</span><span class="mi">9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">nsw</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="o">%</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="mi">10</span>
<span class="w">  </span><span class="n">ret</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="o">%</span><span class="mi">11</span><span class="w">                                     </span><span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">è¿”å›è¯­å¥</span>
<span class="p">;</span><span class="w"> </span><span class="n">æ³¨é‡Š</span><span class="o">:</span><span class="w"> </span><span class="n">ç¬¬ä¸‰ä¸ªåŸºæœ¬å—çš„ç»“æŸ</span>
<span class="p">}</span>

<span class="n">attributes</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">noinline</span><span class="w"> </span><span class="n">nounwind</span><span class="w"> </span><span class="n">optnone</span><span class="w"> </span><span class="n">uwtable</span><span class="w"> </span><span class="s">&quot;correctly-rounded-divide-sqrt-fp-math&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;disable-tail-calls&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;frame-pointer&quot;</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="w"> </span><span class="s">&quot;less-precise-fpmad&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;min-legal-vector-width&quot;</span><span class="o">=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="s">&quot;no-infs-fp-math&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;no-jump-tables&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;no-nans-fp-math&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;no-signed-zeros-fp-math&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;no-trapping-math&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;stack-protector-buffer-size&quot;</span><span class="o">=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="s">&quot;target-cpu&quot;</span><span class="o">=</span><span class="s">&quot;x86-64&quot;</span><span class="w"> </span><span class="s">&quot;target-features&quot;</span><span class="o">=</span><span class="s">&quot;+cx8,+fxsr,+mmx,+sse,+sse2,+x87&quot;</span><span class="w"> </span><span class="s">&quot;unsafe-fp-math&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="s">&quot;use-soft-float&quot;</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="p">}</span>

<span class="o">!</span><span class="n">llvm</span><span class="p">.</span><span class="n">module</span><span class="p">.</span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="p">{</span><span class="o">!</span><span class="mi">0</span><span class="p">}</span>
<span class="o">!</span><span class="n">llvm</span><span class="p">.</span><span class="n">ident</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="p">{</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span>

<span class="o">!</span><span class="mi">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="p">{</span><span class="n">i32</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="s">&quot;wchar_size&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="mi">4</span><span class="p">}</span>
<span class="o">!</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="p">{</span><span class="o">!</span><span class="s">&quot;clang version 10.0.1 &quot;</span><span class="p">}</span>
</code></pre></div>
<p>å…¶ä¸­ï¼Œæ¯ä¸ªç¨‹åºç”±ä¸€ä¸ªä¸ªæˆ–å¤šä¸ªæ¨¡å—ç»„æˆï¼Œæ¨¡å—ä¹‹é—´ç”±é“¾æ¥å™¨åˆå¹¶ï¼ˆæœ¬å®éªŒä¸­å¹¶ä¸æ¶‰åŠï¼‰ã€‚
  æ¯ä¸ªæ¨¡å—ç»„æˆå¦‚ä¸‹ï¼š</p>
<ul>
<li>ç›®æ ‡ä¿¡æ¯ï¼š</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">target</span><span class="w"> </span><span class="n">datalayout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-f80:128-n8:16:32:64-S128&quot;</span>
<span class="n">target</span><span class="w"> </span><span class="n">triple</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;x86_64-unknown-linux-gnu&quot;</span>
</code></pre></div>
<ul>
<li>å…¨å±€ç¬¦å·: å…¨å±€å˜é‡ã€å‡½æ•°å®šä¹‰</li>
<li>å…¶å®ƒä¿¡æ¯</li>
</ul>
<p>æ¯ä¸ªå‡½æ•°çš„ç»„æˆå¦‚ä¸‹ï¼š</p>
<ul>
<li>å¤´éƒ¨ï¼šå‡½æ•°è¿”å›å€¼ç±»å‹ï¼Œå‡½æ•°åï¼Œå‡½æ•°å‚æ•°</li>
<li>ä¸€ä¸ªæˆ–å¤šä¸ªåŸºæœ¬å—ï¼š</li>
<li>
<p>æ¯ä¸ªåŸºæœ¬å—åˆæœ‰æ ‡ç­¾å’ŒæŒ‡ä»¤ç»„æˆã€‚</p>
<div class="highlight"><pre><span></span><code><span class="mi">8</span><span class="o">:</span><span class="w">                                                </span><span class="p">;</span><span class="w"> </span><span class="n">preds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">%</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="mi">0</span>
<span class="w">  </span><span class="o">%</span><span class="mi">9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">i32</span><span class="p">,</span><span class="w"> </span><span class="n">i32</span><span class="o">*</span><span class="w"> </span><span class="o">%</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="o">%</span><span class="mi">11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">nsw</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="o">%</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="mi">10</span>
<span class="w">  </span><span class="n">ret</span><span class="w"> </span><span class="n">i32</span><span class="w"> </span><span class="o">%</span><span class="mi">11</span>
</code></pre></div>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>8</code> å°±æ˜¯æ ‡ç­¾ã€‚
<code>%9 = load i32, i32* %2, align 4</code> ä¸­çš„ <code>%9</code> æ˜¯ç›®çš„æ“ä½œæ•°ï¼Œ<code>load</code> æ˜¯æŒ‡ä»¤åŠ©è®°ç¬¦ï¼Œ<code>i32</code> æ˜¯ 32 ä½æ•´å‹ï¼Œ<code>i32*</code> æ˜¯æŒ‡å‘ <code>i32</code> çš„æŒ‡é’ˆç±»å‹ï¼Œ<code>%2</code> æ˜¯æºæ“ä½œæ•°ï¼Œ<code>align 4</code> è¡¨ç¤º 4 å­—èŠ‚å¯¹é½ã€‚</p>
</li>
</ul>
<h2 id="ir-æŒ‡ä»¤">IR æŒ‡ä»¤<a class="headerlink" href="#ir-æŒ‡ä»¤" title="Permanent link">&para;</a></h2>
<ul>
<li>é‡‡ç”¨ 3 åœ°å€çš„æ–¹å¼</li>
<li>åŒºåˆ«äº X86 æ±‡ç¼–çš„ç›®æ ‡å’Œæºå¯„å­˜å™¨å…±ç”¨çš„æ¨¡å¼ï¼šADD EAX, EBX</li>
<li>%2 = add i32 %0, %1</li>
<li>SSA å½¢å¼ + æ— é™å¯„å­˜å™¨</li>
<li>æ¯ä¸ªå˜é‡éƒ½åªè¢«èµ‹å€¼ä¸€æ¬¡</li>
<li>å®¹æ˜“ç¡®å®šæ“ä½œé—´çš„ä¾èµ–å…³ç³»ï¼Œä¾¿äºä¼˜åŒ–åˆ†æ</li>
<li>å¼ºç±»å‹ç³»ç»Ÿ</li>
<li>æ¯ä¸ª Value éƒ½å…·å¤‡è‡ªèº«çš„ç±»å‹ï¼Œ</li>
<li>IR ç±»å‹ç³»ç»Ÿï¼š<ul>
<li><code>i1</code>ï¼š1 ä½å®½çš„æ•´æ•°ç±»å‹</li>
<li><code>i32</code>ï¼š32 ä½å®½çš„æ•´æ•°ç±»å‹</li>
<li><code>float</code>ï¼šå•ç²¾åº¦æµ®ç‚¹æ•°ç±»å‹</li>
<li><code>pointer</code>ï¼šæŒ‡é’ˆç±»å‹</li>
<li>ä¾‹å¦‚ï¼š<code>i32*, [10 x i32*]</code></li>
<li><code>label</code>: åŸºæœ¬å¿«çš„æ ‡è¯†ç¬¦ç±»å‹</li>
<li><code>functiontype</code>ï¼šå‡½æ•°ç±»å‹ï¼ŒåŒ…æ‹¬å‡½æ•°è¿”å›å€¼ç±»å‹ä¸å‚æ•°ç±»å‹</li>
</ul>
</li>
</ul>
<h3 id="æŒ‡ä»¤æ ¼å¼">æŒ‡ä»¤æ ¼å¼<a class="headerlink" href="#æŒ‡ä»¤æ ¼å¼" title="Permanent link">&para;</a></h3>
<h4 id="terminator-instructions">Terminator Instructions<a class="headerlink" href="#terminator-instructions" title="Permanent link">&para;</a></h4>
<p><strong>æ³¨</strong>ï¼šret ä¸ br éƒ½æ˜¯ Terminator Instructions ä¹Ÿå°±æ˜¯ç»ˆæ­¢æŒ‡ä»¤ï¼Œåœ¨ llvm åŸºæœ¬å—çš„å®šä¹‰é‡Œï¼ŒåŸºæœ¬å—æ˜¯å•è¿›å•å‡ºçš„ï¼Œå› æ­¤åªèƒ½æœ‰ä¸€æ¡ç»ˆæ­¢æŒ‡ä»¤ï¼ˆret æˆ– brï¼‰ã€‚å½“ä¸€ä¸ªåŸºæœ¬å—æœ‰ä¸¤æ¡ç»ˆæ­¢æŒ‡ä»¤ï¼Œclang åœ¨åšè§£æä¼šè®¤ä¸ºç¬¬ä¸€ä¸ªç»ˆç»“æŒ‡ä»¤æ˜¯æ­¤åŸºæœ¬å—çš„ç»“æŸï¼Œå¹¶ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„åŒ¿åçš„åŸºæœ¬å—ï¼ˆå¹¶å ç”¨äº†ä¸‹ä¸€ä¸ªç¼–å·ï¼‰ã€‚</p>
<h5 id="ret">Ret<a class="headerlink" href="#ret" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼šè¿”å›æŒ‡ä»¤ã€‚ç”¨äºå°†æ§åˆ¶æµï¼ˆä»¥åŠå¯é€‰çš„å€¼ï¼‰ä»å‡½æ•°è¿”å›ç»™è°ƒç”¨è€…ã€‚<code>ret</code> æŒ‡ä»¤æœ‰ä¸¤ç§å½¢å¼ï¼šä¸€ç§è¿”å›å€¼ï¼Œç„¶åç»ˆç»“å‡½æ•°ï¼Œå¦ä¸€ç§ä»…ç»ˆç»“å‡½æ•°ã€‚</li>
<li>æ ¼å¼</li>
<li><code>ret &lt;type&gt; &lt;value&gt;</code></li>
<li><code>ret void</code></li>
<li>ä¾‹å­ï¼š</li>
<li><code>ret i32 %0</code></li>
<li><code>ret void</code></li>
</ul>
<h5 id="br">Br<a class="headerlink" href="#br" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼šè·³è½¬æŒ‡ä»¤ã€‚ç”¨äºä½¿æ§åˆ¶æµè½¬ç§»åˆ°å½“å‰åŠŸèƒ½ä¸­çš„å¦ä¸€ä¸ªåŸºæœ¬å—ã€‚è¯¥æŒ‡ä»¤æœ‰ä¸¤ç§å½¢å¼ï¼Œåˆ†åˆ«å¯¹åº”äºæ¡ä»¶åˆ†æ”¯å’Œæ— æ¡ä»¶åˆ†æ”¯ã€‚</li>
<li>æ ¼å¼ï¼š</li>
<li><code>br i1 &lt;cond&gt;, label &lt;iftrue&gt;, label &lt;iffalse&gt;</code></li>
<li><code>br label &lt;dest&gt;</code></li>
<li>ä¾‹å­ï¼š</li>
<li><code>br i1 %cond label %truebb label %falsebb</code></li>
<li><code>br label %bb</code></li>
</ul>
<h4 id="standard-binary-operators">Standard Binary Operators<a class="headerlink" href="#standard-binary-operators" title="Permanent link">&para;</a></h4>
<h5 id="add-fadd">Add FAdd<a class="headerlink" href="#add-fadd" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>add</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>i32</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹å’Œï¼Œè¿”å›å€¼ä¸º <code>i32</code> ç±»å‹ï¼Œ<code>fadd</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>float</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹å’Œï¼Œè¿”å›å€¼ä¸º <code>float</code> ç±»å‹ã€‚</li>
<li>æ ¼å¼ï¼š</li>
<li><code>&lt;result&gt; = add &lt;type&gt; &lt;op1&gt;, &lt;op2&gt;</code></li>
<li><code>&lt;result&gt; = fadd &lt;type&gt; &lt;op1&gt;, &lt;op2&gt;</code></li>
<li>ä¾‹å­ï¼š</li>
<li><code>%2 = add i32 %1, %0</code></li>
<li><code>%2 = fadd float %1, %0</code></li>
</ul>
<h5 id="sub-fsub">Sub FSub<a class="headerlink" href="#sub-fsub" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>sub</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>i32</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹å·®ï¼Œè¿”å›å€¼ä¸º <code>i32</code> ç±»å‹ï¼Œ<code>fsub</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>float</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹å·®ï¼Œè¿”å›å€¼ä¸º <code>float</code> ç±»å‹ã€‚</li>
<li>æ ¼å¼ä¸ä¾‹å­ä¸ <code>add</code>ï¼Œ<code>fadd</code> ç±»ä¼¼</li>
</ul>
<h5 id="mul-fmul">Mul FMul<a class="headerlink" href="#mul-fmul" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>mul</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>i32</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹ç§¯ï¼Œè¿”å›å€¼ä¸º <code>i32</code> ç±»å‹ï¼Œ<code>fmul</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>float</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹ç§¯ï¼Œè¿”å›å€¼ä¸º <code>float</code> ç±»å‹ã€‚</li>
<li>æ ¼å¼ä¸ä¾‹å­ä¸ <code>add</code>ï¼Œ<code>fadd</code> ç±»ä¼¼</li>
</ul>
<h5 id="sdiv-fdiv">SDiv FDiv<a class="headerlink" href="#sdiv-fdiv" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>sdiv</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>i32</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹å•†ï¼Œè¿”å›å€¼ä¸º <code>i32</code> ç±»å‹ï¼Œ<code>fdiv</code> æŒ‡ä»¤è¿”å›å…¶ä¸¤ä¸ª <code>float</code> ç±»å‹çš„æ“ä½œæ•°ä¹‹å•†ï¼Œè¿”å›å€¼ä¸º <code>float</code> ç±»å‹ã€‚</li>
<li>æ ¼å¼ä¸ä¾‹å­ä¸ <code>add</code>ï¼Œ<code>fadd</code> ç±»ä¼¼</li>
</ul>
<h4 id="memory-operators">Memory Operators<a class="headerlink" href="#memory-operators" title="Permanent link">&para;</a></h4>
<h5 id="alloca">Alloca<a class="headerlink" href="#alloca" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>alloca</code> æŒ‡ä»¤åœ¨å½“å‰æ‰§è¡Œå‡½æ•°çš„å †æ ˆå¸§ä¸Šåˆ†é…å†…å­˜ï¼Œå½“è¯¥å‡½æ•°è¿”å›å…¶è°ƒç”¨è€…æ—¶å°†è‡ªåŠ¨é‡Šæ”¾è¯¥å†…å­˜ã€‚å§‹ç»ˆåœ¨åœ°å€ç©ºé—´ä¸­ä¸ºæ•°æ®å¸ƒå±€ä¸­æŒ‡ç¤ºçš„åˆ†é…èµ„æºåˆ†é…å¯¹è±¡ã€‚</li>
<li>æ ¼å¼ï¼š<code>&lt;result&gt; = alloca &lt;type&gt;</code></li>
<li>ä¾‹å­ï¼š</li>
<li><code>%ptr = alloca i32</code></li>
<li><code>%ptr = alloca [10 x i32]</code></li>
</ul>
<h5 id="load">Load<a class="headerlink" href="#load" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>load</code> æŒ‡ä»¤ç”¨äºä»å†…å­˜ä¸­è¯»å–ã€‚</li>
<li>æ ¼å¼ï¼š<code>&lt;result&gt; = load &lt;type&gt;, &lt;type&gt;* &lt;pointer&gt;</code></li>
<li>ä¾‹å­ï¼š<code>%val = load i32, i32* %ptr</code></li>
</ul>
<h5 id="store">Store<a class="headerlink" href="#store" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>store</code> æŒ‡ä»¤ç”¨äºå†™å…¥å†…å­˜ã€‚</li>
<li>æ ¼å¼ï¼š<code>store &lt;type&gt; &lt;value&gt;, &lt;type&gt;* &lt;pointer&gt;</code></li>
<li>ä¾‹å­ï¼š<code>store i32 3, i32* %ptr</code></li>
</ul>
<h4 id="castinst">CastInst<a class="headerlink" href="#castinst" title="Permanent link">&para;</a></h4>
<h5 id="zext">ZExt<a class="headerlink" href="#zext" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>zext</code> æŒ‡ä»¤å°†å…¶æ“ä½œæ•° <strong>é›¶</strong> æ‰©å±•ä¸º <code>type2</code> ç±»å‹ã€‚</li>
<li>æ ¼å¼ï¼š<code>&lt;result&gt; = zext &lt;type&gt; &lt;value&gt; to &lt;type2&gt;</code></li>
<li>ä¾‹å­ï¼š<code>%1 = zext i1 %0 to i32</code></li>
</ul>
<h5 id="fptosi">FpToSi<a class="headerlink" href="#fptosi" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>fptosi</code> æŒ‡ä»¤å°†æµ®ç‚¹å€¼è½¬æ¢ä¸º <code>type2</code>ï¼ˆæ•´æ•°ï¼‰ç±»å‹ã€‚</li>
<li>æ ¼å¼ï¼š<code>&lt;result&gt; = fptosi &lt;type&gt; &lt;value&gt; to &lt;type2&gt;</code></li>
<li>ä¾‹å­ï¼š<code>%Y = fptosi float 1.0E-247 to i32</code></li>
</ul>
<h5 id="sitofp">SiToFp<a class="headerlink" href="#sitofp" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>sitofp</code> æŒ‡ä»¤å°†æœ‰ç¬¦å·æ•´æ•°è½¬æ¢ä¸º <code>type2</code>ï¼ˆæµ®ç‚¹æ•°ï¼‰ç±»å‹ã€‚</li>
<li>æ ¼å¼ï¼š<code>&lt;result&gt; = sitofp &lt;type&gt; &lt;value&gt; to &lt;type2&gt;</code></li>
<li>ä¾‹å­ï¼š<code>%X = sitofp i32 257 to float</code></li>
</ul>
<h4 id="other-operators">Other Operators<a class="headerlink" href="#other-operators" title="Permanent link">&para;</a></h4>
<h5 id="icmp-fcmp">ICmp FCmp<a class="headerlink" href="#icmp-fcmp" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>icmp</code> æŒ‡ä»¤æ ¹æ®ä¸¤ä¸ªæ•´æ•°çš„æ¯”è¾ƒè¿”å›å¸ƒå°”å€¼ï¼Œ<code>fcmp</code> æŒ‡ä»¤æ ¹æ®ä¸¤ä¸ªæµ®ç‚¹æ•°çš„æ¯”è¾ƒè¿”å›å¸ƒå°”å€¼ã€‚</li>
<li>æ ¼å¼ï¼š</li>
<li><code>&lt;result&gt; = icmp &lt;cond&gt; &lt;type&gt; &lt;op1&gt;, &lt;op2&gt;</code><ul>
<li><code>&lt;cond&gt; = eq | ne | sgt | sge | slt | sle</code></li>
</ul>
</li>
<li><code>&lt;result&gt; = fcmp &lt;cond&gt; &lt;type&gt; &lt;op1&gt;, &lt;op2&gt;</code><ul>
<li><code>&lt;cond&gt; = eq | ne | ugt | uge | ult | ule</code></li>
</ul>
</li>
<li>ä¾‹å­ï¼š<code>i1 %2 = icmp sge i32 %0, %1</code></li>
</ul>
<h5 id="call">Call<a class="headerlink" href="#call" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>call</code> æŒ‡ä»¤ç”¨äºä½¿æ§åˆ¶æµè½¬ç§»åˆ°æŒ‡å®šçš„å‡½æ•°ï¼Œå…¶ä¼ å…¥å‚æ•°ç»‘å®šåˆ°æŒ‡å®šçš„å€¼ã€‚åœ¨è¢«è°ƒç”¨å‡½æ•°ä¸­æ‰§è¡Œ <code>ret</code> æŒ‡ä»¤åï¼Œæ§åˆ¶æµç¨‹å°†åœ¨å‡½æ•°è°ƒç”¨åç»§ç»­æ‰§è¡Œè¯¥æŒ‡ä»¤ï¼Œå¹¶ä¸”è¯¥å‡½æ•°çš„è¿”å›å€¼ç»‘å®šåˆ° <code>result</code> å‚æ•°ã€‚</li>
<li>æ ¼å¼ï¼š</li>
<li><code>&lt;result&gt; = call &lt;return ty&gt; &lt;func name&gt;(&lt;function args&gt;)</code></li>
<li>ä¾‹å­ï¼š</li>
<li><code>%0 = call i32 @func( i32 %1, i32* %0)</code></li>
<li><code>call @func( i32 %arg)</code></li>
</ul>
<h5 id="getelementptr">GetElementPtr<a class="headerlink" href="#getelementptr" title="Permanent link">&para;</a></h5>
<ul>
<li>æ¦‚å¿µï¼š<code>getelementptr</code> æŒ‡ä»¤ç”¨äºè·å–æ•°ç»„ç»“æ„çš„å…ƒç´ çš„åœ°å€ã€‚å®ƒä»…æ‰§è¡Œåœ°å€è®¡ç®—ï¼Œå¹¶ä¸”ä¸è®¿é—®å†…å­˜ã€‚</li>
<li>æ ¼å¼ï¼š<code>&lt;result&gt; = getelementptr &lt;type&gt;, &lt;type&gt;* &lt;ptrval&gt; [, &lt;type&gt; &lt;idx&gt;]</code></li>
<li>å‚æ•°è§£é‡Šï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è®¡ç®—åŸºç¡€ç±»å‹ï¼Œç¬¬äºŒç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºç´¢å¼•å¼€å§‹çš„æŒ‡é’ˆç±»å‹åŠæŒ‡é’ˆï¼Œ<code>[]</code> è¡¨ç¤ºå¯é‡å¤å‚æ•°ï¼Œé‡Œé¢è¡¨ç¤ºçš„æ•°ç»„ç´¢å¼•çš„åç§»ç±»å‹åŠåç§»å€¼ã€‚ï¼ˆQuestionï¼šæ€è€ƒæŒ‡é’ˆç±»å‹ä¸º <code>[10 x i32]</code> æŒ‡é’ˆå’Œ <code>i32</code> æŒ‡é’ˆ <code>getelementptr</code> ç”¨æ³•çš„ä¸åŒï¼Œå¹¶ç»™å‡ºè§£é‡Šï¼Œå®éªŒç»“æŸåå›ç­”ä¸¤è€…ä½¿ç”¨æƒ…å†µçš„åŒºåˆ«ï¼‰</li>
<li>ä¾‹å­ï¼š</li>
<li><code>%2 = getelementptr [10 x i32], [10 x i32]* %1, i32 0, i32 %0</code></li>
<li><code>%2 = getelementptr i32, i32* %1 i32 %0</code></li>
<li><strong>é¢å¤–é˜…è¯»ï¼ˆå¾ˆé‡è¦ï¼‰</strong>ï¼š<a href="https://llvm.org/docs/GetElementPtr.html">The Often Misunderstood GEP Instruction</a></li>
</ul>
<h2 id="c-apis">C++ APIs<a class="headerlink" href="#c-apis" title="Permanent link">&para;</a></h2>
<h3 id="c-ç±»å…³ç³»å›¾">C++ ç±»å…³ç³»å›¾<a class="headerlink" href="#c-ç±»å…³ç³»å›¾" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../../../img/ddda5faa196b34cc84e0649c08c1a892_MD5.png" /></p>
<p>ä¸Šé¢æ˜¯ c++ ä»£ç çš„ç±»å…³ç³»å›¾ã€‚</p>
<ul>
<li><code>Module</code> ç±»è¡¨ç¤º IR çš„æ¨¡å—ï¼Œæ˜¯ IR æœ€ä¸Šå±‚çš„ç»“æ„ã€‚</li>
<li><code>Type</code> ç±»è¡¨ç¤º IR çš„ç±»å‹ï¼Œæ´¾ç”Ÿå‡º <code>ArrayType</code>, <code>FloatType</code>, <code>FunctionType</code>, <code>IntegerType</code> å’Œ <code>PointerType</code> ç­‰åˆ†åˆ«è¡¨ç¤ºçš„æ•°ç»„ç±»å‹ã€æµ®ç‚¹å‹ã€å‡½æ•°ç±»å‹ã€æ•´æ•°å‹å’ŒæŒ‡é’ˆç±»å‹ã€‚ä¾‹å¦‚ï¼Œå‡½æ•°å¤´éƒ¨çš„è¿”å›å€¼ç±»å‹ç”¨ä¸€ä¸ª <code>Type</code> å¯¹è±¡è¡¨ç¤ºï¼Œå‡½æ•°çš„å‚æ•°è¡¨ä¸­æ¯ä¸ªå‚æ•°çš„ç±»å‹ä¹Ÿæ˜¯ç”¨ <code>Type</code> å¯¹è±¡è¡¨ç¤ºï¼ˆé€šå¸¸æ˜¯ <code>Type</code> çš„æŸä¸ªå­ç±»ï¼‰ï¼Œè€Œå‚æ•°çš„å€¼åˆ™æ˜¯ç”¨ <code>Value</code> å¯¹è±¡è¡¨ç¤ºã€‚è¿”å›å€¼ç±»å‹å’Œå‚æ•°ç±»å‹ä¸€èµ·æ„æˆäº†å‡½æ•°ç±»å‹ï¼Œç”¨ <code>FunctionType</code> å¯¹è±¡è¡¨ç¤ºã€‚</li>
<li><code>Use</code> ç±»ç”¨äºæè¿° <code>Value</code> çš„ä½¿ç”¨æƒ…å†µï¼Œ<code>Value</code> ç±»æˆå‘˜æœ‰ä¸€ä¸ª <code>Use</code> é“¾è¡¨æ¥è¡¨ç¤ºä½¿ç”¨å…¶çš„æ“ä½œæ•°é“¾è¡¨ã€‚</li>
<li><code>Value</code> ç±»è¡¨ç¤ºå€¼ï¼Œå…·ä½“å¯ä»¥æ˜¯ <code>Argument</code>, <code>BasicBlock</code>, <code>Function</code> æˆ– <code>User</code> æ¯ä¸€ä¸ª <code>Value</code> å¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå·±çš„ç±»å‹ã€‚</li>
<li><code>Function</code> ç±»è¡¨ç¤ºå‡½æ•°çš„å®šä¹‰ï¼Œå…¶ä¸­ï¼Œæˆå‘˜ <code>std::list&lt;Argument *&gt; arguments_</code> è¡¨ç¤ºå‡½æ•°çš„å‚æ•°ï¼ˆå½¢å‚ï¼‰ã€‚</li>
<li><code>BasicBlock</code> è¡¨ç¤ºåŸºæœ¬å—ã€‚</li>
<li><code>User</code> ç±»æè¿°äº†å€¼çš„ä½¿ç”¨æƒ…å†µï¼Œä¾‹å¦‚æŸä¸ª <code>Instruction</code> ä½¿ç”¨äº†å“ªäº›æ“ä½œæ•°ã€‚<ul>
<li><code>Constant</code> ç±»è¡¨ç¤ºå¸¸é‡ï¼Œæ´¾ç”Ÿå‡ºå„ç§ç±»å‹çš„å¸¸é‡ã€‚</li>
<li><code>GlobalVariable</code> ç±»è¡¨ç¤ºå…¨å±€å˜é‡ï¼Œåœ¨ IR ä¸­ä½äºæ¨¡å—å†…ï¼Œä¸å‡½æ•°å¹¶åˆ—ã€‚</li>
<li><code>Instruction</code> ç±»è¡¨ç¤ºåŸºæœ¬å—ä¸­çš„ IR æŒ‡ä»¤ï¼Œæ´¾ç”Ÿå‡ºå…·ä½“çš„å„ç§æŒ‡ä»¤ã€‚</li>
</ul>
</li>
</ul>
<p>ä¸‹é¢æ˜¯å¯¹å„ä¸ªç±»è¿›è¡Œå…·ä½“çš„ä»‹ç»ã€‚</p>
<h3 id="module">Module<a class="headerlink" href="#module" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šä¸€ä¸ªç¼–è¯‘å•å…ƒã€‚åœ¨ <code>cminus-f</code> æ„ä¹‰ä¸‹è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ã€‚</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Module</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// å°†å‡½æ•°fæ·»åŠ åˆ°è¯¥æ¨¡å—çš„å‡½æ•°é“¾è¡¨ä¸Š</span>
<span class="w">    </span><span class="c1">// åœ¨å‡½æ•°è¢«åˆ›å»ºçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">add_function</span><span class="p">(</span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">f</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å°†å…¨å±€å˜é‡gæ·»åŠ åˆ°è¯¥æ¨¡å—çš„å…¨å±€å˜é‡é“¾è¡¨ä¸Š</span>
<span class="w">    </span><span class="c1">// åœ¨å…¨å±€å˜é‡è¢«åˆ›å»ºçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_global_variable</span><span class="p">(</span><span class="n">GlobalVariable</span><span class="o">*</span><span class="w"> </span><span class="n">g</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è·å–å…¨å±€å˜é‡åˆ—è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">GlobalVariable</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">get_global_variable</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è·å¾—ï¼ˆåˆ›å»ºï¼‰è‡ªå®šä¹‰çš„Pointerç±»å‹</span>
<span class="w">    </span><span class="n">PointerType</span><span class="w"> </span><span class="o">*</span><span class="nf">get_pointer_type</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">contained</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è·å¾—ï¼ˆåˆ›å»ºï¼‰è‡ªå®šä¹‰çš„Arrayç±»å‹</span>
<span class="w">    </span><span class="n">ArrayType</span><span class="w"> </span><span class="o">*</span><span class="nf">get_array_type</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">contained</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_elements</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è·å¾—åŸºæœ¬ç±»å‹int32</span>
<span class="w">    </span><span class="n">IntegerType</span><span class="w"> </span><span class="o">*</span><span class="nf">get_int32_type</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// å…¶ä»–åŸºæœ¬ç±»å‹ç±»ä¼¼...</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// å­˜å‚¨å…¨å±€å˜é‡çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">GlobalVariable</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">global_list_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å­˜å‚¨å‡½æ•°çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Function</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">function_list_</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// å­˜å‚¨åŸºæœ¬ç±»å‹</span>
<span class="w">    </span><span class="n">IntegerType</span><span class="w"> </span><span class="o">*</span><span class="n">int1_ty_</span><span class="p">;</span>
<span class="w">    </span><span class="n">IntegerType</span><span class="w"> </span><span class="o">*</span><span class="n">int32_ty_</span><span class="p">;</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">label_ty_</span><span class="p">;</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">void_ty_</span><span class="p">;</span>
<span class="w">    </span><span class="n">FloatType</span><span class="w"> </span><span class="o">*</span><span class="n">float32_ty_</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// å­˜å‚¨è‡ªå®šä¹‰ç±»å‹</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">PointerType</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">pointer_map_</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">ArrayType</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">array_map_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="basicblock">BasicBlock<a class="headerlink" href="#basicblock" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šåŸºæœ¬å—ã€‚æ˜¯ä¸€ä¸ªæ˜¯å•å…¥å£å•å‡ºå£çš„ä»£ç å—ï¼Œå¯ä»¥ä½œä¸ºåˆ†æ”¯æŒ‡ä»¤ç›®æ ‡å¯¹è±¡ã€‚</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BasicBlock</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Value</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// åˆ›å»ºå¹¶è¿”å›åŸºæœ¬å—ï¼Œå‚æ•°åˆ†åˆ«æ˜¯åŸºæœ¬å—æ‰€å±çš„æ¨¡å—ï¼ŒåŸºæœ¬å—åå­—ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰ï¼ŒåŸºæœ¬å—æ‰€å±çš„å‡½æ•°</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">create</span><span class="p">(</span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥åŸºæœ¬å—æ‰€å±çš„å‡½æ•°</span>
<span class="w">    </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="nf">get_parent</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥åŸºæœ¬å—æ‰€å±çš„æ¨¡å—</span>
<span class="w">    </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="nf">get_module</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥åŸºæœ¬å—çš„ç»ˆæ­¢æŒ‡ä»¤ï¼Œè‹¥åŸºæœ¬å—çš„æœ€åä¸€æ¡æŒ‡ä»¤ä¸æ˜¯ç»ˆæ­¢æŒ‡ä»¤è¿”å›åˆ™è¿”å› nullptr</span>
<span class="w">    </span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="nf">get_terminator</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// å°†æŒ‡ä»¤ instr æ·»åŠ åˆ°è¯¥åŸºæœ¬å—çš„æŒ‡ä»¤é“¾è¡¨æœ«ç«¯ï¼Œä½¿ç”¨ IRBuilder æ¥åˆ›å»ºå‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_instruction</span><span class="p">(</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">instr</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å°†æŒ‡ä»¤ instr æ·»åŠ åˆ°è¯¥åŸºæœ¬å—çš„æŒ‡ä»¤é“¾è¡¨é¦–éƒ¨</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_instr_begin</span><span class="p">(</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">instr</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å°†æŒ‡ä»¤ instr ä»è¯¥åŸºæœ¬å—çš„æŒ‡ä»¤é“¾è¡¨ä¸­ç§»é™¤ï¼Œè¯¥ API ä¼šåŒæ—¶ç»´æŠ¤å¥½ instr çš„æ“ä½œæ•°çš„ use é“¾è¡¨ã€‚</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">delete_instr</span><span class="p">(</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">instr</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// åˆ¤æ–­è¯¥åŸºæœ¬å—æ˜¯å¦ä¸ºç©º</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">empty</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥åŸºæœ¬å—ä¸­çš„æŒ‡ä»¤æ•°ç›®</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">get_num_of_instr</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥åŸºæœ¬å—çš„æŒ‡ä»¤é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">get_instructions</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// å°†è¯¥åŸºæœ¬å—ä»æ‰€å±å‡½æ•°çš„åŸºæœ¬å—é“¾è¡¨ä¸­ç§»é™¤</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">erase_from_parent</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/****************APIs about cfg****************/</span>
<span class="w">    </span><span class="c1">// è¿”å›å‰é©±åŸºæœ¬å—é›†åˆ</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">get_pre_basic_blocks</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è¿”å›åç»§åŸºæœ¬å—é›†åˆ</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">get_succ_basic_blocks</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// æ·»åŠ å‰é©±åŸºæœ¬å—</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_pre_basic_block</span><span class="p">(</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">bb</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// æ·»åŠ åç»§åŸºæœ¬å—</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_succ_basic_block</span><span class="p">(</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">bb</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// ç§»é™¤å‰é©±åŸºæœ¬å—</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">remove_pre_basic_block</span><span class="p">(</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">bb</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// ç§»é™¤åç»§åŸºæœ¬å—</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">remove_succ_basic_block</span><span class="p">(</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">bb</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/****************APIs about cfg****************/</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// å­˜å‚¨å‰é©±åŸºæœ¬å—çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">pre_bbs_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å­˜å‚¨åç»§åŸºæœ¬å—çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">succ_bbs_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å­˜å‚¨è¯¥åŸºæœ¬å—æŒ‡ä»¤çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">instr_list_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// æŒ‡å‘è¯¥åŸºæœ¬å—æ‰€å±å‡½æ•°çš„æŒ‡é’ˆ</span>
<span class="w">    </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">parent_</span><span class="p">;</span>

<span class="p">};</span>
</code></pre></div>
<h3 id="globalvariable">GlobalVariable<a class="headerlink" href="#globalvariable" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šå…¨å±€å˜é‡ã€‚</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GlobalVariable</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">User</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">GlobalVariable</span><span class="w"> </span><span class="o">*</span><span class="n">create</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="o">*</span><span class="w"> </span><span class="n">ty</span><span class="p">,</span>
<span class="w">                                  </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_const</span><span class="p">,</span><span class="w"> </span><span class="n">Constant</span><span class="o">*</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="constant">Constant<a class="headerlink" href="#constant" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šå¸¸é‡ã€‚ä¸åŒç±»å‹çš„å¸¸é‡ç”±ä¸åŒç±»æ¥è¡¨ç¤ºã€‚</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Constant</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">User</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">Constant</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">ty</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<p>æ•´å‹å¸¸é‡ ConstantInt çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ConstantInt</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Constant</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¯¥å¸¸é‡è¡¨ç¤ºçš„å€¼</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">value_</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥å¸¸é‡ä¸­å­˜çš„æ•°</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">get_value</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è¿”å›å¸¸é‡ const_val ä¸­å­˜çš„æ•°</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="n">ConstantInt</span><span class="w"> </span><span class="o">*</span><span class="n">const_val</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// ä»¥å€¼ val æ¥åˆ›å»ºå¸¸é‡</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ConstantInt</span><span class="w"> </span><span class="o">*</span><span class="nf">get</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// ä»¥å€¼ val æ¥åˆ›å»º bool å¸¸é‡</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ConstantInt</span><span class="w"> </span><span class="o">*</span><span class="nf">get</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<p>æµ®ç‚¹æ•°å¸¸é‡ ConstantFP çš„å®šä¹‰ </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ConstantFP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Constant</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¯¥å¸¸é‡è¡¨ç¤ºçš„å€¼</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">val_</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// ä»¥å€¼ val åˆ›å»ºå¹¶è¿”å›æµ®ç‚¹æ•°å¸¸é‡</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ConstantFP</span><span class="w"> </span><span class="o">*</span><span class="n">get</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥å¸¸é‡ä¸­å­˜çš„å€¼</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="nf">get_value</span><span class="p">();</span>
<span class="p">};</span>
</code></pre></div>
<p>ConstantZero çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="c1">// ç”¨äºå…¨å±€å˜é‡åˆå§‹åŒ–çš„é›¶å¸¸é‡</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConstantZero</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Constant</span><span class="w"> </span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// åˆ›å»ºå¹¶è¿”å›é›¶å¸¸é‡</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ConstantZero</span><span class="w"> </span><span class="o">*</span><span class="n">get</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">ty</span><span class="p">,</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="argument">Argument<a class="headerlink" href="#argument" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šå‡½æ•°çš„å‚æ•°ã€‚</li>
</ul>
<p>Argument çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Argument</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Value</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥å‚æ•°çš„æ‰€å±çš„å‡½æ•°</span>
<span class="w">    </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">get_parent</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥å‚æ•°åœ¨æ‰€åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­çš„åºæ•°</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="nf">get_arg_no</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// æŒ‡å‘è¯¥å‚æ•°çš„æ‰€å±çš„å‡½æ•°çš„æŒ‡é’ˆ</span>
<span class="w">    </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">parent_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è¯¥å‚æ•°åœ¨æ‰€åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­çš„åºæ•°</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">arg_no_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="function">Function<a class="headerlink" href="#function" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šå‡½æ•°ã€‚è¯¥ç±»æè¿°äº†ä¸€ä¸ªè¿‡ç¨‹ï¼ŒåŒ…å«å¤šä¸ªåŸºæœ¬å—ã€‚</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Function</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Value</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// åˆ›å»ºå¹¶è¿”å›å‡½æ•°ï¼Œå‚æ•°ä¾æ¬¡æ˜¯å¾…åˆ›å»ºå‡½æ•°ç±»å‹ tyï¼Œå‡½æ•°åå­— name (ä¸å¯ä¸ºç©º)ï¼Œå‡½æ•°æ‰€å±çš„æ¨¡å— parent</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">create</span><span class="p">(</span><span class="n">FunctionType</span><span class="w"> </span><span class="o">*</span><span class="n">ty</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥å‡½æ•°çš„å‡½æ•°ç±»å‹</span>
<span class="w">    </span><span class="n">FunctionType</span><span class="w"> </span><span class="o">*</span><span class="nf">get_function_type</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥å‡½æ•°çš„è¿”å›å€¼ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="nf">get_return_type</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å°†åŸºæœ¬å— bb æ·»åŠ è‡³è¯¥å‡½æ•°æœ«ç«¯ï¼ˆè°ƒç”¨åŸºæœ¬å—çš„åˆ›å»ºå‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æ­¤å‡½æ•°æ¥ï¼‰</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_basic_block</span><span class="p">(</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">bb</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å¾—åˆ°è¯¥å‡½æ•°å‚æ•°æ•°é‡</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="nf">get_num_of_args</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å¾—åˆ°è¯¥å‡½æ•°åŸºæœ¬å—æ•°é‡</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="nf">get_num_basic_blocks</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å¾—åˆ°è¯¥å‡½æ•°æ‰€å±çš„Module</span>
<span class="w">    </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="nf">get_parent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å¾—åˆ°è¯¥å‡½æ•°å‚æ•°åˆ—è¡¨çš„èµ·å§‹è¿­ä»£å™¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Argument</span><span class="w"> </span><span class="o">*&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">arg_begin</span><span class="p">()</span>
<span class="w">    </span><span class="c1">// å¾—åˆ°è¯¥å‡½æ•°å‚æ•°åˆ—è¡¨çš„ç»ˆæ­¢è¿­ä»£å™¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Argument</span><span class="w"> </span><span class="o">*&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">arg_end</span><span class="p">()</span>
<span class="w">    </span><span class="c1">// ä»å‡½æ•°çš„åŸºæœ¬å—é“¾è¡¨ä¸­åˆ é™¤åŸºæœ¬å— bb</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">remove</span><span class="p">(</span><span class="n">BasicBlock</span><span class="o">*</span><span class="w"> </span><span class="n">bb</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// è¿”å›å‡½æ•°åŸºæœ¬å—é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">get_basic_blocks</span><span class="p">()</span>
<span class="w">    </span><span class="c1">// è¿”å›å‡½æ•°çš„å‚æ•°é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Argument</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">get_args</span><span class="p">()</span>
<span class="w">    </span><span class="c1">// ç»™å‡½æ•°ä¸­æœªå‘½åçš„åŸºæœ¬å—å’ŒæŒ‡ä»¤å‘½å</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">set_instr_name</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// å‚¨å­˜åŸºæœ¬å—çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">basic_blocks_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å‚¨å­˜å‚æ•°çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Argument</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">arguments_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// æŒ‡å‘è¯¥å‡½æ•°æ‰€å±çš„æ¨¡å—çš„æŒ‡é’ˆ</span>
<span class="w">    </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">parent_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="irbuilder">IRBuilder<a class="headerlink" href="#irbuilder" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šç”Ÿæˆ IR çš„è¾…åŠ©ç±»ã€‚è¯¥ç±»æä¾›äº†ç‹¬ç«‹çš„æ¥å£åˆ›å»ºå„ç§ IR æŒ‡ä»¤ï¼Œå¹¶å°†å®ƒä»¬æ’å…¥åŸºæœ¬å—ä¸­ï¼ˆæ³¨æ„ï¼šè¯¥è¾…åŠ©ç±»ä¸åšä»»ä½•ç±»å‹æ£€æŸ¥ï¼‰ã€‚</li>
</ul>
<p>IRBuilder çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IRBuilder</span><span class="w"> </span><span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¯¥è¾…åŠ©ç±»æ­£åœ¨æ’å…¥çš„åŸºæœ¬å—</span>
<span class="w">    </span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">BB_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è¯¥è¾…åŠ©ç±»ç»‘å®šçš„æ¨¡å—</span>
<span class="w">    </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m_</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¿”å›å½“å‰æ’å…¥çš„åŸºæœ¬å—</span>
<span class="w">    </span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">get_insert_block</span><span class="p">()</span>
<span class="w">    </span><span class="c1">// è®¾ç½®å½“å‰æ’å…¥çš„åŸºæœ¬å—</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">set_insert_point</span><span class="p">(</span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">bb</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// åˆ›å»ºçš„æŒ‡ä»¤å¹¶å¯¹åº”æ’å…¥åˆ°åŸºæœ¬å—ä¸­ï¼Œå‡½æ•°åå­—å’Œå‚æ•°åå­—å’ŒIRæ–‡æ¡£æ˜¯ä¸€ä¸€å¯¹åº”çš„</span>
<span class="w">    </span><span class="c1">// å…·ä½“æŸ¥çœ‹ IRBuilder.h</span>
<span class="w">    </span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">create_</span><span class="p">[</span><span class="n">instr_type</span><span class="p">]();</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="instruction">Instruction<a class="headerlink" href="#instruction" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šæŒ‡ä»¤ã€‚è¯¥ç±»æ˜¯æ‰€æœ‰ LLVM æŒ‡ä»¤çš„åŸºç±»ã€‚å­ç±»åŒ…å« IR éƒ¨åˆ†ä¸­çš„æ‰€æœ‰æŒ‡ä»¤ã€‚</li>
</ul>
<p>Instruction çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Instruction</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">User</span>
<span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¯¥æŒ‡ä»¤æ‰€å±çš„åŸºæœ¬å—</span>
<span class="w">    </span><span class="n">BasicBlock</span><span class="w"> </span><span class="o">*</span><span class="n">parent_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è¯¥æŒ‡ä»¤çš„ç±»å‹id</span>
<span class="w">    </span><span class="n">OpID</span><span class="w"> </span><span class="n">op_id_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è¯¥æŒ‡ä»¤çš„æ“ä½œæ•°ä¸ªæ•°</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_ops_</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// æ‰€æœ‰æŒ‡ä»¤çš„åˆ›å»ºéƒ½è¦é€šè¿‡IRBuilderè¿›è¡Œï¼Œæš‚ä¸éœ€è¦å…³æ³¨Instructionç±»çš„å®ç°ç»†èŠ‚</span>
<span class="w">    </span><span class="c1">//ï¼ˆæ³¨ï¼šä¸é€šè¿‡IRBuilderæ¥åˆ›å»ºæŒ‡ä»¤ï¼Œè€Œç›´æ¥è°ƒç”¨æŒ‡ä»¤å­ç±»çš„åˆ›å»ºæ–¹æ³•æœªç»åŠ©æ•™å®Œå–„çš„æµ‹è¯•ï¼‰</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="type">Type<a class="headerlink" href="#type" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šIR çš„ç±»å‹ï¼ˆåŒ…å« VoidTypeã€LabelTypeã€FloatTypeã€IntegerTypeã€ArrayTypeã€PointerTypeï¼‰ã€‚module ä¸­å¯ä»¥é€šè¿‡ API è·å¾—åŸºæœ¬ç±»å‹ï¼Œå¹¶åˆ›å»ºè‡ªå®šä¹‰ç±»å‹ã€‚</li>
<li>å­ç±»ä»‹ç»ï¼šå…¶ä¸­ ArrayTypeã€PointerType å¯ä»¥åµŒå¥—å¾—åˆ°è‡ªå®šä¹‰ç±»å‹ï¼Œè€Œ VoidTypeã€IntegerTypeï¼ŒFloatType å¯çœ‹åš IR çš„åŸºæœ¬ç±»å‹ï¼ŒLabelType æ˜¯ BasicBlcok çš„ç±»å‹ï¼Œå¯ä½œä¸ºè·³è½¬æŒ‡ä»¤çš„å‚æ•°ï¼ŒFunctionType è¡¨ç¤ºå‡½æ•°ç±»å‹ã€‚å…¶ä¸­ VoidType ä¸ LabelType æ²¡æœ‰å¯¹åº”çš„å­ç±»ï¼Œé€šè¿‡ Type ä¸­çš„ tid_ å­—æ®µåˆ¤åˆ«ï¼Œè€Œå…¶ä»–ç±»å‹å‡æœ‰å¯¹åº”å­ç±»</li>
</ul>
<p>Type çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Type</span><span class="w"> </span><span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// ç±»å‹ç§ç±»</span>
<span class="w">    </span><span class="n">TypeID</span><span class="w"> </span><span class="n">tid_</span><span class="p">;</span>
<span class="w">    </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m_</span><span class="p">;</span><span class="w"> </span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// åˆ¤æ–­æ˜¯å¦æ˜¯tyç±»å‹</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_</span><span class="p">[</span><span class="n">ty</span><span class="p">]</span><span class="n">_type</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è·å¾—tyç±»å‹</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">get_</span><span class="p">[</span><span class="n">ty</span><span class="p">]</span><span class="n">_type</span><span class="p">(</span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// è‹¥æ˜¯PointerTypeåˆ™è¿”å›æŒ‡å‘çš„ç±»å‹ï¼Œè‹¥ä¸æ˜¯åˆ™è¿”å›nullptrã€‚</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">get_pointer_element_type</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è‹¥æ˜¯ArrayTypeåˆ™è¿”å›æ•°ç»„å…ƒç´ çš„ç±»å‹ï¼Œè‹¥ä¸æ˜¯åˆ™è¿”å›nullptrã€‚</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="nf">get_array_element_type</span><span class="p">();</span>
<span class="p">};</span>
</code></pre></div>
<p>IntegerType çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IntegerType</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="k">explicit</span><span class="w"> </span><span class="n">IntegerType</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_bits</span><span class="w"> </span><span class="p">,</span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// åˆ›å»º IntegerType ç±»å‹ï¼ŒIntegerType åŒ…å« int1 ä¸ int32 </span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">IntegerType</span><span class="w"> </span><span class="o">*</span><span class="nf">get</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_bits</span><span class="p">,</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è·å¾— IntegerType ç±»å‹çš„é•¿åº¦</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="nf">get_num_bits</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¡¨ç¤º IntegerType ç±»å‹çš„é•¿åº¦</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_bits_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>FloatType çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FloatType</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">FloatType</span><span class="w"> </span><span class="p">(</span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// åˆ›å»º FloatType ç±»å‹</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">FloatType</span><span class="w"> </span><span class="o">*</span><span class="nf">get</span><span class="p">(</span><span class="n">Module</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<p>æ•°ç»„ç±»å‹ ArrayType çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ArrayType</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// åˆ¤æ–­æ•°ç»„å…ƒç´ ç±»å‹æ˜¯å¦åˆæ³•</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_valid_element_type</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">ty</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// é€šè¿‡æ•°ç»„å…ƒç´ ç±»å‹containedä»¥åŠæ•°ç»„é•¿åº¦num_elementsåˆ›å»ºæ•°ç»„ç±»å‹</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ArrayType</span><span class="w"> </span><span class="o">*</span><span class="nf">get</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">contained</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_elements</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å¾—åˆ°è¯¥æ•°ç»„ç±»å‹çš„å…ƒç´ ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="nf">get_element_type</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è·å¾—è¯¥æ•°ç»„ç±»å‹çš„é•¿åº¦</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="nf">get_num_of_elements</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// æ•°ç»„å…ƒç´ ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">contained_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// æ•°ç»„é•¿åº¦</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_elements_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>æŒ‡é’ˆç±»å‹ PointerType çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PointerType</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è·å–è¯¥æŒ‡é’ˆç±»å‹æŒ‡å‘çš„å…ƒç´ ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">get_element_type</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// åˆ›å»ºæŒ‡å‘ç±»å‹ä¸ºcontainedçš„æŒ‡é’ˆç±»å‹</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">PointerType</span><span class="w"> </span><span class="o">*</span><span class="nf">get</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">contained</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è®°å½•æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">contained_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>å‡½æ•°ç±»å‹ FunctionType çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FunctionType</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// åˆ¤æ–­è¿”å›å€¼ç±»å‹æ˜¯å¦åˆæ³•</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_valid_return_type</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">ty</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// åˆ¤æ–­å‚æ•°ç±»å‹æ˜¯å¦åˆæ³•</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">is_valid_argument_type</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">ty</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// æ ¹æ®è¿”å›å€¼ç±»å‹resultï¼Œå‚æ•°ç±»å‹åˆ—è¡¨paramsåˆ›å»ºå‡½æ•°ç±»å‹</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">FunctionType</span><span class="w"> </span><span class="o">*</span><span class="nf">get</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">params</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// è¿”å›è¯¥å‡½æ•°ç±»å‹çš„å‚æ•°ä¸ªæ•°</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="nf">get_num_of_args</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è·å¾—è¯¥å‡½æ•°ç±»å‹ç¬¬iä¸ªå‚æ•°çš„ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="nf">get_param_type</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è·å¾—è¯¥å‡½æ•°ç±»å‹çš„å‚æ•°ç±»å‹é“¾è¡¨çš„èµ·å§‹è¿­ä»£å™¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Type</span><span class="w"> </span><span class="o">*&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">param_begin</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è·å¾—è¯¥å‡½æ•°ç±»å‹çš„å‚æ•°ç±»å‹é“¾è¡¨çš„ç»“æŸè¿­ä»£å™¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Type</span><span class="w"> </span><span class="o">*&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">param_end</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// è·å¾—è¯¥å‡½æ•°ç±»å‹çš„è¿”å›å€¼ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="nf">get_return_type</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è¿”å›å€¼çš„ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">result_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å­˜å‚¨è¯¥å‡½æ•°ç±»å‹çš„å‚æ•°ç±»å‹çš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Type</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">args_</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="user">User<a class="headerlink" href="#user" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šä½¿ç”¨è€…ã€‚ç»´æŠ¤äº† use-def ä¿¡æ¯ï¼Œè¡¨ç¤ºè¯¥ä½¿ç”¨è€…ç”¨äº†å“ªäº›å€¼ã€‚</li>
</ul>
<p>User çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">User</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Value</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// ä»è¯¥ä½¿ç”¨è€…çš„æ“ä½œæ•°é“¾è¡¨ä¸­å–å‡ºç¬¬iä¸ªæ“ä½œæ•°</span>
<span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">get_operand</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å°†è¯¥ä½¿ç”¨è€…çš„ç¬¬iä¸ªæ“ä½œæ•°è®¾ä¸ºå€¼v</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">set_operand</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å°†å€¼væ·»åŠ åˆ°è¯¥ä½¿ç”¨è€…çš„æ“ä½œæ•°é“¾è¡¨ä¸Š</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">add_operand</span><span class="p">(</span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å¾—åˆ°æ“ä½œæ•°é“¾è¡¨çš„å¤§å°</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="nf">get_num_operand</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// ä»è¯¥ä½¿ç”¨è€…çš„æ“ä½œæ•°é“¾è¡¨ä¸­çš„æ‰€æœ‰æ“ä½œæ•°çš„ä½¿ç”¨æƒ…å†µä¸­ç§»é™¤è¯¥ä½¿ç”¨è€…</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">remove_use_of_ops</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// ç§»é™¤æ“ä½œæ•°é“¾è¡¨ä¸­ç´¢å¼•ä¸ºindex1åˆ°index2çš„æ“ä½œæ•°</span>
<span class="w">    </span><span class="c1">// ä¾‹å¦‚æƒ³åˆ é™¤ç¬¬0ä¸ªæ“ä½œæ•°ï¼šremove_operands(0,0)</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">remove_operands</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index1</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">index2</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// å‚æ•°åˆ—è¡¨ï¼Œè¡¨ç¤ºè¯¥ä½¿ç”¨è€…ç”¨åˆ°çš„å‚æ•°</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Value</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">operands_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// è¯¥ä½¿ç”¨è€…ä½¿ç”¨çš„å‚æ•°ä¸ªæ•°</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">num_ops_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="use">Use<a class="headerlink" href="#use" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šä»£è¡¨äº†å€¼çš„ä½¿ç”¨æƒ…å†µã€‚</li>
</ul>
<p>Use çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">Use</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// ä½¿ç”¨è€…</span>
<span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">val_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// ä½¿ç”¨è€…ä¸­å€¼çš„åºæ•°</span>
<span class="w">    </span><span class="c1">// å¯¹äº func(a, b)ï¼Œaä¸º0ï¼Œbä¸º1</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">arg_no_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="value">Value<a class="headerlink" href="#value" title="Permanent link">&para;</a></h3>
<ul>
<li>æ¦‚å¿µï¼šå€¼ã€‚ä»£è¡¨ä¸€ä¸ªå¯èƒ½ç”¨äºæŒ‡ä»¤æ“ä½œæ•°çš„å¸¦ç±»å‹æ•°æ®ï¼Œæ˜¯æœ€åŸºç¡€çš„ç±»ï¼Œç»´æŠ¤äº† def-use ä¿¡æ¯ï¼Œå³è¯¥å€¼è¢«å“ªäº›ä½¿ç”¨è€…ä½¿ç”¨ã€‚</li>
</ul>
<p>Value çš„å®šä¹‰</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Value</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// è·å–è¯¥å€¼çš„ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">get_type</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// å–å¾—è¯¥å€¼çš„ä½¿ç”¨æƒ…å†µ</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Use</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">get_use_list</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">use_list_</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// æ·»åŠ åŠ è¯¥å€¼çš„ä½¿ç”¨æƒ…å†µ</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">add_use</span><span class="p">(</span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">arg_no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// åœ¨æ‰€æœ‰åœ°æ–¹å°†è¯¥å€¼ç”¨æ–°çš„å€¼ new_val æ›¿æ¢ï¼Œå¹¶ç»´æŠ¤å¥½use_defå’Œdef_useé“¾è¡¨</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">replace_all_use_with</span><span class="p">(</span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">new_val</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// å°†å€¼ val ä»ä½¿ç”¨é“¾è¡¨ä¸­ç§»é™¤</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">remove_use</span><span class="p">(</span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">val</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// å€¼çš„ç±»å‹</span>
<span class="w">    </span><span class="n">Type</span><span class="w"> </span><span class="o">*</span><span class="n">type_</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// å‚¨å­˜äº†è¯¥å€¼çš„ä½¿ç”¨æƒ…å†µçš„é“¾è¡¨</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Use</span><span class="o">&gt;</span><span class="w"> </span><span class="n">use_list_</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="æ³¨æ„">æ³¨æ„<a class="headerlink" href="#æ³¨æ„" title="Permanent link">&para;</a></h3>
<p>åŠ©æ•™åœ¨æ¥å£æ–‡æ¡£é‡Œç­›é€‰äº†å¯èƒ½ä¼šéœ€è¦ç”¨åˆ°çš„æ¥å£ï¼Œå¦‚æœå¯¹ API æœ‰é—®é¢˜çš„è¯·ç§»æ­¥ issue è®¨è®ºï¼Œæœ¬æ¬¡ <code>lightir</code> æ¥å£ç”±åŠ©æ•™è‡ªè¡Œè®¾è®¡å®ç°ï¼Œå¹¶åšäº†å¤§é‡æµ‹è¯•ï¼Œå¦‚æœ‰å¯¹åŠ©æ•™çš„å®ç°æ–¹æ³•æœ‰å¼‚è®®æˆ–è€…å»ºè®®çš„ä¹Ÿè¯·ç§»æ­¥ issue è®¨è®ºï¼Œ<strong>è¯·ä¸è¦ç›´æ¥ä¿®æ”¹åŠ©æ•™çš„ä»£ç ï¼Œè‹¥å› ä¿®æ”¹åŠ©æ•™ä»£ç é€ æˆåç»­å®éªŒä»“åº“åˆå¹¶çš„å†²çªè¯·è‡ªè¡Œè§£å†³</strong>ã€‚</p>

  <hr>
<div class="md-source-file">
  <small>
    
      æœ€åæ›´æ–°:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2023å¹´8æœˆ11æ—¥ 10:45:38</span>
      
        <br>
        åˆ›å»ºæ—¥æœŸ:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2023å¹´8æœˆ11æ—¥ 10:45:38</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            å›åˆ°é¡µé¢é¡¶éƒ¨
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright Â© 2022 Apostle-lemon
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Apostle-lemon" target="_blank" rel="noopener" title="github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top", "search.highlight", "search.share"], "search": "../../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>