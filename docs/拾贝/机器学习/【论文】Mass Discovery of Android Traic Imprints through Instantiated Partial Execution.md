# Mass Discovery of Android Traffic Imprints Through Instantiated Partial Execution

Android 流量印记是指 Android 应用程序在网络通信过程中产生的特定的数据流模式或特征。这些印记可以包括数据包的大小、协议类型、通信时间和目的地等信息，可以用于区分不同应用程序的网络行为，以及识别潜在的网络安全问题和威胁。

Instantiated Partial Execution 是指通过动态分析技术，在执行过程中针对某个特定的代码块进行部分执行，而不是对整个程序进行完整执行。

以往的研究依赖于自动探索应用程序的用户界面（UI）来触发其网络活动，但这种方法很难扩展，因为操作成本高（每个应用程序至少需要 5 分钟）且有效性有限（无法涵盖应用程序的所有行为）。

Tiger 采用了一种新颖的反向切片技术，对应用程序代码中发现的每个网络 API 进行处理。与传统的切片算法不同，我们的技术不断评估与网络 API 相关的每个程序语句，以发现不太可能影响 API 输出（网络数据包）任何常量值的变量。一旦发现这样的变量，就会立即通过为其分配适当的具体值来实例化它，以避免在上游进一步回溯可能对变量产生影响的其他语句。

为了进一步降低分析的复杂性，Tiger 还识别了不同切片之间的共享代码，并使用之前分析中生成的具体值替换它们的输出。

我们提出了一种新技术，能够高效地触发应用程序的网络活动并发现其不变令牌。我们的方法利用高效的部分执行技术，针对潜在的不变量并通过实例化与不变量无关的变量来显著简化网络汇的代码片段。

正如之前提到的，Tiger 旨在对 Android 应用进行全面、可扩展的分析，自动识别应用程序中网络通信中的不变令牌。其核心思想是静态地定位应用程序中的所有网络 sink，然后对程序进行切片和修剪，识别与可能的不变量相关的语句，然后部分执行简化的切片以生成不变的令牌（如果它们确实存在）。为了实现这一目标，Tiger 包括一系列技术创新：它首先运行一个粗略（但快速）的切片操作，以建立语句（更精确地说是其变量）与内部不变量源（例如常量值、清单或其他资源内容）的关系；在这些语句中，它进一步进行差分分析，找到值对可能的不变令牌没有影响的变量。通过为这些变量分配具体值（实例化），IPE 避免了回溯影响这些变量的语句的成本，并产生了一个简化的切片（带有较少的语句），可以快速执行以获取令牌，用于构建应用程序的流量特征。

