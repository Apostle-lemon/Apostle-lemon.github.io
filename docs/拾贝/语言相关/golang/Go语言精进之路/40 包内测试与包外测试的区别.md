# 包内测试与包外测试的区别

所有测试代码要存放在 \*\_test.go 结尾的文件中。

go test 命令会将当前包目录下的所有的 \*\_test.go 编译成一个临时的二进制文件。（也可以通过 go test -c 显式编译出该文件），并执行该文件。执行时运行所有符合 Testxxx 命名规范的函数。

## 包内测试的优势和不足

包内测试可以访问该包下的所有符号，包括导出的和未导出的。包内测试是面向实现的白盒测试。

其会需要经常性的维护。因为内部的实现逻辑和数据结构的设计都会不断进行优化和调整。

包循环调用是非常常见的问题。

## 包外测试

包外测试是面向接口的黑盒测试。

包外测试的单元覆盖率不足，不过我们可以采用 **安插后门** 的形式解决这个问题。我们需要在被测试包内构造一个 export_test.go 文件。由于这个文件以 \_test.go 结尾，因此在产品正式代码中不会被包含，同时其内部又不包含任何测试代码。其作用仅仅是将被测包内的内部符号在测试阶段暴露给包外测试代码。在代码中，我们可以设计一些拓展的方法，也可以通过 var IsSpace = isSpace 的方式将符号变为导出的。
